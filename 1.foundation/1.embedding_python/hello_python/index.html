
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Learn Engine Dev is tutorial series for developing a cross platform game engine from scratch." name="description"/>
<meta content="Chukobyte" name="author"/>
<link href="../../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.1.2, mkdocs-material-7.1.4" name="generator"/>
<title>Hello Python - Learn Engine Dev</title>
<link href="../../../assets/stylesheets/main.bde7dde4.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.ef6f36e2.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-7S3213MH0R"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-7S3213MH0R');
  gtag('send','pageview');

  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  });
</script>
</head>
<body data-md-color-accent="none" data-md-color-primary="none" data-md-color-scheme="" dir="ltr">
<script>function __prefix(e){return new URL("../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#hello-python">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Learn Engine Dev" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="Learn Engine Dev">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Learn Engine Dev
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Hello Python
            
          </span>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" data-md-state="active" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</label>
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/Chukobyte/learn-engine-dev" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Learn Engine Dev" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="Learn Engine Dev">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"></path></svg>
</a>
    Learn Engine Dev
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/Chukobyte/learn-engine-dev" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../..">
        Introduction
      </a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2">
        1. Foundation
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="1. Foundation" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
          1. Foundation
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1" id="__nav_2_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_1">
        Embedding Python
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Embedding Python" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_1">
<span class="md-nav__icon md-icon"></span>
          Embedding Python
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          Hello Python
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        Hello Python
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#dependencies">
    Dependencies
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#build">
    Build
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#hello-world">
    Hello World
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#execute-a-python-function-from-c">
    Execute A Python Function From C++
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../embedding_further/">
        Embedding Further
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../custom_python_module/">
        Custom Python Module
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" id="__nav_2_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_2">
        Game Loop &amp; SDL
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Game Loop &amp; SDL" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_2">
<span class="md-nav__icon md-icon"></span>
          Game Loop &amp; SDL
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../2.game_loop_and_sdl/game_loop_introduction/">
        Game Loop Introduction
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2.game_loop_and_sdl/initialize_sdl/">
        Initialize SDL
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3" id="__nav_2_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_3">
        OpenGL Rendering
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="OpenGL Rendering" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_3">
<span class="md-nav__icon md-icon"></span>
          OpenGL Rendering
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../3.opengl_rendering/asset_management/">
        Asset Management
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../3.opengl_rendering/rendering_sprites/">
        Rendering Sprites
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../3.opengl_rendering/rendering_text/">
        Rendering Text
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_4" id="__nav_2_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_4">
        Implementing Audio
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Implementing Audio" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_4">
<span class="md-nav__icon md-icon"></span>
          Implementing Audio
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../4.implementing_audio/using_sdl_mixer/">
        Using SDL_mixer
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_5" id="__nav_2_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_5">
        Input Management
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Input Management" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_5">
<span class="md-nav__icon md-icon"></span>
          Input Management
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../5.input_management/input_events/">
        Input Events
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../5.input_management/input_management/">
        Input Management
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_6" id="__nav_2_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_6">
        Entity Component System
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Entity Component System" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_6">
<span class="md-nav__icon md-icon"></span>
          Entity Component System
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../6.entity_component_system/building_an_ecs/">
        Building An ECS
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../6.entity_component_system/managers/">
        Managers
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../6.entity_component_system/ecs_orchestrator/">
        ECS Orchestrator
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_7" id="__nav_2_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_7">
        Serializing With JSON
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Serializing With JSON" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_7">
<span class="md-nav__icon md-icon"></span>
          Serializing With JSON
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../7.serializing_with_json/parsing_json_properties_file/">
        Parsing JSON Properties File
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../7.serializing_with_json/creating_scene_json_files/">
        Creating Scene Json Files
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3">
        2. Engine API
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="2. Engine API" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
          2. Engine API
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.engine_api/about/">
        Defining Red Engine API
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4">
        3. Games
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="3. Games" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
          3. Games
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.games/about/">
        Making Games
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../source_code/source_code/">
        Source Code
      </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#dependencies">
    Dependencies
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#build">
    Build
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#hello-world">
    Hello World
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#execute-a-python-function-from-c">
    Execute A Python Function From C++
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="hello-python">Hello Python</h1>
<h2 id="dependencies">Dependencies</h2>
<p>For this tutorial, we'll be using Python 3.7 but feel free to try other versions as well.  Python must be downloaded and installed locally before continuing.  Windows users be sure to include the <code>python37.dll</code> in the same directory as the <code>red_engine</code> executable.</p>
<h2 id="build">Build</h2>
<p>For building the engine in a cross platform way we will be using <a href="https://www.gnu.org/software/make/">make</a>.  I won't being going into the specifics of Makefiles in this series, but you can find a pretty solid tutorial <a href="https://makefiletutorial.com/">here</a>.  To make the paths for dependencies configurable we'll set environment variables throughout the tutorial, but feel free to hardcode these values for your convenience.</p>
<p>For python there are two environment variables:</p>
<ul>
<li><code>PYTHON_INCLUDE</code> The python installation's include folder.  Should contain <code>Python.h</code>.</li>
<li><code>PYTHON_LIBS</code> The python installation's lib folder.  Should contain the python <code>a.</code> file used during linking.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nv">PROJECT_NAME</span> <span class="o">:=</span> red_engine

<span class="c"># OS Specific Stuff</span>
<span class="cp">ifeq ($(OS),Windows_NT)</span>
    OS_TYPE :<span class="o">=</span> windows
    BUILD_OBJECT :<span class="o">=</span> <span class="k">$(</span>PROJECT_NAME<span class="k">)</span>.exe
    L_FLAGS :<span class="o">=</span> -lmingw32 -lpython37 -static-libgcc -static-libstdc++
    DELETE_CMD :<span class="o">=</span> del
<span class="cp">else</span>
    OS_TYPE :<span class="o">=</span> linux
    BUILD_OBJECT :<span class="o">=</span> <span class="k">$(</span>PROJECT_NAME<span class="k">)</span>
    L_FLAGS :<span class="o">=</span> -lpython3.7m -lcrypt -lpthread -ldl  -lutil -lm -static-libgcc -static-libstdc++
    DELETE_CMD :<span class="o">=</span> rm
<span class="cp">endif</span>

<span class="nv">CC</span> <span class="o">:=</span> gcc <span class="c1"># C Compiler</span>
<span class="nv">CXX</span> <span class="o">:=</span> g++ <span class="c1"># C++ compiler</span>
<span class="nv">I_FLAGS</span> <span class="o">:=</span> -I<span class="s2">"</span><span class="si">${</span><span class="nv">PYTHON_INCLUDE</span><span class="si">}</span><span class="s2">"</span>
<span class="nv">LIBRARIES</span> <span class="o">:=</span> -L<span class="s2">"</span><span class="si">${</span><span class="nv">PYTHON_LIBS</span><span class="si">}</span><span class="s2">"</span>
<span class="nv">CPP_FLAGS</span> <span class="o">:=</span> -w -std<span class="o">=</span>c++14 -Wfatal-errors

<span class="nv">SRC</span> <span class="o">=</span> <span class="k">$(</span>wildcard src/*.cpp<span class="k">)</span>

<span class="nv">OBJ</span> <span class="o">=</span> <span class="k">$(</span>SRC:.cpp<span class="o">=</span>.o<span class="k">)</span>

<span class="c"># MAIN</span>

<span class="nf">.PHONY</span><span class="o">:</span> <span class="n">all</span> <span class="n">build</span> <span class="n">clean</span>

<span class="nf">all</span><span class="o">:</span> <span class="n">clean</span> <span class="n">format</span> <span class="n">build</span>

<span class="c"># Compiles if .o is missing or changes to the .cpp file</span>
<span class="nf">%.o</span><span class="o">:</span> %.<span class="n">cpp</span>
    @echo <span class="s2">"Compiling "</span> $&lt; <span class="s2">" into "</span> <span class="nv">$@</span>
    @<span class="k">$(</span>CXX<span class="k">)</span> -c <span class="k">$(</span>CPP_FLAGS<span class="k">)</span> $&lt; -o <span class="nv">$@</span> <span class="k">$(</span>I_FLAGS<span class="k">)</span>

<span class="nf">build</span><span class="o">:</span> <span class="k">$(</span><span class="nv">OBJ</span><span class="k">)</span>
    @echo <span class="s2">"Linking "</span> <span class="nv">$@</span>
    @<span class="k">$(</span>CXX<span class="k">)</span> -o <span class="k">$(</span>BUILD_OBJECT<span class="k">)</span> $^ <span class="k">$(</span>I_FLAGS<span class="k">)</span> <span class="k">$(</span>L_FLAGS<span class="k">)</span> <span class="k">$(</span>LIBRARIES<span class="k">)</span>

<span class="nf">clean</span><span class="o">:</span>
<span class="cp">ifneq ("$(wildcard $(BUILD_OBJECT))","")</span>
    <span class="k">$(</span>DELETE_CMD<span class="k">)</span> <span class="k">$(</span>BUILD_OBJECT<span class="k">)</span>
<span class="cp">endif</span>
<span class="cp">ifeq ($(OS_TYPE),windows)</span>
    <span class="k">$(</span>foreach object, <span class="k">$(</span>OBJ<span class="k">)</span>, del <span class="k">$(</span>subst /,<span class="se">\,</span><span class="k">$(</span>object<span class="k">))</span><span class="p">;</span><span class="k">)</span>
<span class="cp">else</span>
    <span class="k">$(</span>foreach object, <span class="k">$(</span>OBJ<span class="k">)</span>, rm <span class="k">$(</span>object<span class="k">)</span><span class="p">;</span><span class="k">)</span>
<span class="cp">endif</span>

<span class="nf">run</span><span class="o">:</span>
    @./<span class="k">$(</span>BUILD_OBJECT<span class="k">)</span>

<span class="nf">format</span><span class="o">:</span>
    @astyle -n --style<span class="o">=</span>google --recursive src/*.cpp

<span class="c"># Adds debug symbols for debugger</span>
<span class="nf">debug-build</span><span class="o">:</span> <span class="n">C_FLAGS</span> +=  -<span class="n">g</span>
<span class="nf">debug-build</span><span class="o">:</span> <span class="n">build</span>
</code></pre></div>
<p><em>Note: You can echo the full compile and linking commands to the console by removing <code>@</code> on lines 51 and 55.</em></p>
<h2 id="hello-world">Hello World</h2>
<p>It's time to finally write python code within <strong><em>Red Engine</em></strong>!  Before we start diving deeper into creating a scripting system for python, let's first obtain a small win by having out engine print out a statement via python.  Full documentation for embedding python within a c++ application can be found <a href="https://docs.python.org/3/extending/embedding.html">here</a>.</p>
<div class="highlight"><pre><span></span><code><span class="cp">#define PY_SSIZE_T_CLEAN</span>
<span class="cp">#include</span> <span class="cpf">&lt;Python.h&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argv</span><span class="p">,</span> <span class="kt">char</span><span class="o">**</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Py_SetProgramName</span><span class="p">(</span><span class="sa">L</span><span class="s">"red_engine"</span><span class="p">);</span>
    <span class="n">Py_Initialize</span><span class="p">();</span>

    <span class="n">PyRun_SimpleString</span><span class="p">(</span><span class="s">"print('hello world (from python)')"</span><span class="p">);</span>

    <span class="n">Py_Finalize</span><span class="p">();</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>This should print out <em>'hello world (from python)'</em>.  There's other things we can setup before initializing the python interpreter but for now we'll just set the python application name with <code>Py_SetProgramName</code>. <code>Py_Initialize</code> initializes the python interpreter.</p>
<p>Next we call <code>PyRun_SimpleString</code> to execute this python statement:
<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="s1">'hello world (from python)'</span><span class="p">)</span>
</code></pre></div></p>
<p>Last but not least we terminate the python interpreter by calling <code>Py_Finalize()</code>.  Not too bad of a start but we can definitely do better!  You view the code by looking at the source <a href="https://github.com/Chukobyte/learn-engine-dev/tree/main/src/1.foundation/1.embedding_python/1.0.hello_python">here</a>.</p>
<p>We will want to execute scripts and python functions from <strong><em>Red Engine</em></strong> and also be able to call C++ functions from a python script.  Let's work on that next!</p>
<h2 id="execute-a-python-function-from-c">Execute A Python Function From C++</h2>
<p>Executing python statements with <code>PyRun_SimpleString</code> is simple but it won't scale very well once we start adding more logic in python.  Let's create a new python script and call a function from it!</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">play</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Game played!"</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span>
</code></pre></div>
<p>A simple python function that prints the statement <em>'Game played!'</em> to the console.  Next let's call this function in C++.</p>
<div class="highlight"><pre><span></span><code><span class="cp">#define PY_SSIZE_T_CLEAN</span>
<span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;Python.h&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argv</span><span class="p">,</span> <span class="kt">char</span><span class="o">**</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Py_SetProgramName</span><span class="p">(</span><span class="sa">L</span><span class="s">"red_engine"</span><span class="p">);</span>
    <span class="n">Py_Initialize</span><span class="p">();</span>
    <span class="n">PyRun_SimpleString</span><span class="p">(</span><span class="s">"import sys"</span><span class="p">);</span>
    <span class="n">PyRun_SimpleString</span><span class="p">(</span><span class="s">"sys.path.append(</span><span class="se">\"</span><span class="s">.</span><span class="se">\"</span><span class="s">)"</span><span class="p">);</span>

    <span class="c1">// Load Module</span>
    <span class="n">PyObject</span><span class="o">*</span> <span class="n">pModuleName</span> <span class="o">=</span> <span class="n">PyUnicode_FromString</span><span class="p">(</span><span class="s">"assets.scripts.game"</span><span class="p">);</span>
    <span class="n">PyObject</span><span class="o">*</span> <span class="n">pModule</span> <span class="o">=</span> <span class="n">PyImport_Import</span><span class="p">(</span><span class="n">pModuleName</span><span class="p">);</span>
    <span class="n">Py_DECREF</span><span class="p">(</span><span class="n">pModuleName</span><span class="p">);</span>
    <span class="n">assert</span><span class="p">(</span><span class="n">pModule</span> <span class="o">!=</span> <span class="k">nullptr</span> <span class="o">&amp;&amp;</span> <span class="s">"Not able to load python module!"</span><span class="p">);</span>

    <span class="c1">// Function</span>
    <span class="n">PyObject</span><span class="o">*</span> <span class="n">pFunc</span> <span class="o">=</span> <span class="n">PyObject_GetAttrString</span><span class="p">(</span><span class="n">pModule</span><span class="p">,</span> <span class="s">"play"</span><span class="p">);</span>
    <span class="n">assert</span><span class="p">(</span><span class="n">pFunc</span> <span class="o">!=</span> <span class="k">nullptr</span> <span class="o">&amp;&amp;</span> <span class="s">"Not able to find function named 'play'!"</span><span class="p">);</span>
    <span class="n">PyObject</span><span class="o">*</span> <span class="n">pValue</span> <span class="o">=</span> <span class="n">PyObject_CallObject</span><span class="p">(</span><span class="n">pFunc</span><span class="p">,</span> <span class="k">nullptr</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Python script exit code = "</span> <span class="o">&lt;&lt;</span> <span class="n">PyLong_AsLong</span><span class="p">(</span><span class="n">pValue</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="n">Py_DECREF</span><span class="p">(</span><span class="n">pValue</span><span class="p">);</span>
    <span class="n">Py_DECREF</span><span class="p">(</span><span class="n">pFunc</span><span class="p">);</span>
    <span class="n">Py_DECREF</span><span class="p">(</span><span class="n">pModule</span><span class="p">);</span>

    <span class="n">Py_Finalize</span><span class="p">();</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>This is pretty straightforward, the first things to point out are the two <code>PyRun_SimpleString</code> calls.  The first python statement:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">sys</span>
</code></pre></div>
<p>Simply imports the <code>sys</code> module into the interpreter.  The next python statement:
<div class="highlight"><pre><span></span><code><span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"."</span><span class="p">)</span>
</code></pre></div></p>
<p>This adds the current path to the system path in order for python modules to be imported based on the current path.  We would have to provide the full path otherwise.</p>
<p>Next we're getting a python string object with <code>PyUnicode_FromString</code> as we'll need that to import the python module from our script.  The folder path is <code>assets/scripts</code> and the python script is <code>game.py</code>.  After getting the module name we'll now import the module it's pointing to with <code>PyImport_Import</code>.  <code>Py_DECREF</code> is called as we'll need to decrement the reference count of python objects to delete them within python interpreter and prevent memory leaks!</p>
<p>Now that we have imported the module we can get the reference to a function with <code>PyObject_GetAttrString</code>.  With this reference we'll call the function with <code>PyObject_CallObject</code>.  The function <code>play</code> returns an integer and we store this within <code>pValue</code>.  After that we just decrement the remaining python objects we no longer need.  The source for this section can be found <a href="https://github.com/Chukobyte/learn-engine-dev/tree/main/src/1.foundation/1.embedding_python/1.1.calling_a_function">here</a>.</p>
<p>We're able to call a python function from c++ and receive its return value, but incrementing and decrementing the reference count will become tedious.  In the next section we will embed python further into <strong><em>Red Engine</em></strong> and create classes to generalize some of our usages of the Python API.</p>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a class="md-footer__link md-footer__link--prev" href="../../.." rel="prev">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</div>
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Previous
              </span>
              Introduction
            </div>
</div>
</a>
<a class="md-footer__link md-footer__link--next" href="../embedding_further/" rel="next">
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Next
              </span>
              Embedding Further
            </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
<div class="md-footer-copyright__highlight">
            Copyright © 2021 Chukobyte
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
          Material for MkDocs
        </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../../assets/javascripts/workers/search.4fa0e4ee.min.js", "version": null}</script>
<script src="../../../assets/javascripts/bundle.1d3bfcf1.min.js"></script>
</body>
</html>